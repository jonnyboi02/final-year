<template>
    <div>
      <h1>Mint an NFT</h1>
      <input type="file" @change="handleFileUpload" />
      <button @click="mintNFT">Mint NFT</button>
      <h1>Change NFT Ownership</h1>
      <input type="text" v-model="newOwnerAddress" placeholder="New Owner Address" />
      <button @click="changeNFTOwnership">Change Ownership</button>
      <!-- <div>{{ test }}</div>
     -->
     <div>  {{ currentAddress }}</div>
     <div>{{ accountInstance }}</div>
     {{ url }}
     <div>
        {{ contract.address }}
     </div>
     {{ tokens }}

    
    </div>
  </template>


<script>

import Toastify from 'toastify-js';
import 'toastify-js/src/toastify.css';
import Web3 from 'web3';
import nftABI from './contracts/MyNFT.json'
export default{
    data(){
        return{
            nftFile: null,
            newOwnerAddress: '',
            test: "hey",
            url: "",
            // currentAddress: "",
            currentAddress: this.getAddress() ? this.getAddress :  '0x13ca48E880D7A28F4648eEd3B1Dc558E0D0Dc264',
            accountInstance: null,
            etherAccounts: null,
            contract:{
                address: "",
                instance: "",
            },
            tokens:[],
        }
    },
    async mounted(){
        await this.getAccounts();
    },
    methods:{
        handleFileUpload(event) {
            this.nftFile = event.target.files[0]
        },


        async getAddress(){
            const response = fetch("http://127.0.0.1:8000/get_address/", {
                method: "POST", 
                headers: {
                'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    'username': localStorage.getItem('username'), 
                }),
                
            }).then(response => response.json())
            .then(data=>{
                if (data.error){
                    console.log(error)
                }
                else{
                    // this.test2 = data.key
                    this.currentAddress = data.key
                    this.senderPassword = localStorage.getItem('password')
                }
            })
            
            
            
        },
        async getAccounts(){
            const web3 = new Web3("http://localhost:8547");
            const accounts = await web3.eth.getAccounts();
            this.etherAccounts = accounts;
            
        },
        //function to mint an nft, probably deploy contract
        async mintNFT(){
            //uploads the nft, we have a file that we can use for minting
            const formData = new FormData();
            formData.append("file", this.nftFile);
            const response = await fetch("http://localhost:8000/generate-url/", {
                method: "POST",
                body: formData
            });
            const data = await response.json();
            this.url = data.url;
            const url = data.url;

            //code to deploy the smart contract
             const web3 = new Web3("http://localhost:8547");
             const accounts = await web3.eth.getAccounts();

             //code to get the account instance to send
             for (let i = 0; i<accounts.length; i++){
                if (JSON.stringify(accounts[i].toLowerCase()) === JSON.stringify(this.currentAddress.toLowerCase())) {
                    //this.test = accounts[i];
                    this.accountInstance = accounts[i];

                    
                    const NFTContract = new web3.eth.Contract(nftABI, null, {data: "60806040523480156200001157600080fd5b506040516200342b3803806200342b8339818101604052810190620000379190620002e8565b818181600090816200004a9190620005b8565b5080600190816200005c9190620005b8565b5050506200007f620000736200008760201b60201c565b6200008f60201b60201c565b50506200069f565b600033905090565b6000600660009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905081600660006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a35050565b6000604051905090565b600080fd5b600080fd5b600080fd5b600080fd5b6000601f19601f8301169050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b620001be8262000173565b810181811067ffffffffffffffff82111715620001e057620001df62000184565b5b80604052505050565b6000620001f562000155565b9050620002038282620001b3565b919050565b600067ffffffffffffffff82111562000226576200022562000184565b5b620002318262000173565b9050602081019050919050565b60005b838110156200025e57808201518184015260208101905062000241565b60008484015250505050565b6000620002816200027b8462000208565b620001e9565b905082815260208101848484011115620002a0576200029f6200016e565b5b620002ad8482856200023e565b509392505050565b600082601f830112620002cd57620002cc62000169565b5b8151620002df8482602086016200026a565b91505092915050565b600080604083850312156200030257620003016200015f565b5b600083015167ffffffffffffffff81111562000323576200032262000164565b5b6200033185828601620002b5565b925050602083015167ffffffffffffffff81111562000355576200035462000164565b5b6200036385828601620002b5565b9150509250929050565b600081519050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b60006002820490506001821680620003c057607f821691505b602082108103620003d657620003d562000378565b5b50919050565b60008190508160005260206000209050919050565b60006020601f8301049050919050565b600082821b905092915050565b600060088302620004407fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff8262000401565b6200044c868362000401565b95508019841693508086168417925050509392505050565b6000819050919050565b6000819050919050565b600062000499620004936200048d8462000464565b6200046e565b62000464565b9050919050565b6000819050919050565b620004b58362000478565b620004cd620004c482620004a0565b8484546200040e565b825550505050565b600090565b620004e4620004d5565b620004f1818484620004aa565b505050565b5b8181101562000519576200050d600082620004da565b600181019050620004f7565b5050565b601f82111562000568576200053281620003dc565b6200053d84620003f1565b810160208510156200054d578190505b620005656200055c85620003f1565b830182620004f6565b50505b505050565b600082821c905092915050565b60006200058d600019846008026200056d565b1980831691505092915050565b6000620005a883836200057a565b9150826002028217905092915050565b620005c3826200036d565b67ffffffffffffffff811115620005df57620005de62000184565b5b620005eb8254620003a7565b620005f88282856200051d565b600060209050601f8311600181146200063057600084156200061b578287015190505b6200062785826200059a565b86555062000697565b601f1984166200064086620003dc565b60005b828110156200066a5784890151825560018201915060208501945060208101905062000643565b868310156200068a578489015162000686601f8916826200057a565b8355505b6001600288020188555050505b505050505050565b612d7c80620006af6000396000f3fe608060405234801561001057600080fd5b50600436106101165760003560e01c80638462151c116100a2578063b88d4fde11610071578063b88d4fde146102df578063c87b56dd146102fb578063d0def5211461032b578063e985e9c51461035b578063f2fde38b1461038b57610116565b80638462151c146102575780638da5cb5b1461028757806395d89b41146102a5578063a22cb465146102c357610116565b806323b872dd116100e957806323b872dd146101b557806342842e0e146101d15780636352211e146101ed57806370a082311461021d578063715018a61461024d57610116565b806301ffc9a71461011b57806306fdde031461014b578063081812fc14610169578063095ea7b314610199575b600080fd5b61013560048036038101906101309190611a13565b6103a7565b6040516101429190611a5b565b60405180910390f35b610153610489565b6040516101609190611b06565b60405180910390f35b610183600480360381019061017e9190611b5e565b61051b565b6040516101909190611bcc565b60405180910390f35b6101b360048036038101906101ae9190611c13565b610561565b005b6101cf60048036038101906101ca9190611c53565b610678565b005b6101eb60048036038101906101e69190611c53565b6106d8565b005b61020760048036038101906102029190611b5e565b6106f8565b6040516102149190611bcc565b60405180910390f35b61023760048036038101906102329190611ca6565b61077e565b6040516102449190611ce2565b60405180910390f35b610255610835565b005b610271600480360381019061026c9190611ca6565b610849565b60405161027e9190611dbb565b60405180910390f35b61028f6108e0565b60405161029c9190611bcc565b60405180910390f35b6102ad61090a565b6040516102ba9190611b06565b60405180910390f35b6102dd60048036038101906102d89190611e09565b61099c565b005b6102f960048036038101906102f49190611f7e565b6109b2565b005b61031560048036038101906103109190611b5e565b610a14565b6040516103229190611b06565b60405180910390f35b610345600480360381019061034091906120a2565b610b01565b6040516103529190611ce2565b60405180910390f35b610375600480360381019061037091906120fe565b610bae565b6040516103829190611a5b565b60405180910390f35b6103a560048036038101906103a09190611ca6565b610c42565b005b60007f80ac58cd000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916148061047257507f5b5e139f000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916145b80610482575061048182610c56565b5b9050919050565b6060600080546104989061216d565b80601f01602080910402602001604051908101604052809291908181526020018280546104c49061216d565b80156105115780601f106104e657610100808354040283529160200191610511565b820191906000526020600020905b8154815290600101906020018083116104f457829003601f168201915b5050505050905090565b600061052682610cc0565b6004600083815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050919050565b600061056c826106f8565b90508073ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff16036105dc576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016105d390612210565b60405180910390fd5b8073ffffffffffffffffffffffffffffffffffffffff166105fb610d0b565b73ffffffffffffffffffffffffffffffffffffffff16148061062a575061062981610624610d0b565b610bae565b5b610669576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610660906122a2565b60405180910390fd5b6106738383610d13565b505050565b610689610683610d0b565b82610dcc565b6106c8576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016106bf90612334565b60405180910390fd5b6106d3838383610e61565b505050565b6106f3838383604051806020016040528060008152506109b2565b505050565b6000806107048361115a565b9050600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff1603610775576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161076c906123a0565b60405180910390fd5b80915050919050565b60008073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff16036107ee576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016107e590612432565b60405180910390fd5b600360008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020549050919050565b61083d611197565b6108476000611215565b565b6060600960008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208054806020026020016040519081016040528092919081815260200182805480156108d457602002820191906000526020600020905b8154815260200190600101908083116108c0575b50505050509050919050565b6000600660009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905090565b6060600180546109199061216d565b80601f01602080910402602001604051908101604052809291908181526020018280546109459061216d565b80156109925780601f1061096757610100808354040283529160200191610992565b820191906000526020600020905b81548152906001019060200180831161097557829003601f168201915b5050505050905090565b6109ae6109a7610d0b565b83836112db565b5050565b6109c36109bd610d0b565b83610dcc565b610a02576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016109f990612334565b60405180910390fd5b610a0e84848484611447565b50505050565b6060610a1f826114a3565b610a5e576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610a55906124c4565b60405180910390fd5b600860008381526020019081526020016000208054610a7c9061216d565b80601f0160208091040260200160405190810160405280929190818152602001828054610aa89061216d565b8015610af55780601f10610aca57610100808354040283529160200191610af5565b820191906000526020600020905b815481529060010190602001808311610ad857829003601f168201915b50505050509050919050565b6000610b0b611197565b60076000815480929190610b1e90612513565b919050555060006007549050610b3484826114e4565b610b3e8184611701565b600960008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190806001815401808255809150506001900390600052602060002001600090919091909150558091505092915050565b6000600560008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16905092915050565b610c4a611197565b610c538161176e565b50565b60007f01ffc9a7000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916149050919050565b610cc9816114a3565b610d08576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610cff906123a0565b60405180910390fd5b50565b600033905090565b816004600083815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550808273ffffffffffffffffffffffffffffffffffffffff16610d86836106f8565b73ffffffffffffffffffffffffffffffffffffffff167f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b92560405160405180910390a45050565b600080610dd8836106f8565b90508073ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff161480610e1a5750610e198185610bae565b5b80610e5857508373ffffffffffffffffffffffffffffffffffffffff16610e408461051b565b73ffffffffffffffffffffffffffffffffffffffff16145b91505092915050565b8273ffffffffffffffffffffffffffffffffffffffff16610e81826106f8565b73ffffffffffffffffffffffffffffffffffffffff1614610ed7576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610ece906125cd565b60405180910390fd5b600073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1603610f46576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610f3d9061265f565b60405180910390fd5b610f5383838360016117f1565b8273ffffffffffffffffffffffffffffffffffffffff16610f73826106f8565b73ffffffffffffffffffffffffffffffffffffffff1614610fc9576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610fc0906125cd565b60405180910390fd5b6004600082815260200190815260200160002060006101000a81549073ffffffffffffffffffffffffffffffffffffffff02191690556001600360008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825403925050819055506001600360008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008282540192505081905550816002600083815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550808273ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef60405160405180910390a461115583838360016117f7565b505050565b60006002600083815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050919050565b61119f610d0b565b73ffffffffffffffffffffffffffffffffffffffff166111bd6108e0565b73ffffffffffffffffffffffffffffffffffffffff1614611213576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161120a906126cb565b60405180910390fd5b565b6000600660009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16905081600660006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508173ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a35050565b8173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1603611349576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161134090612737565b60405180910390fd5b80600560008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055508173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff167f17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c318360405161143a9190611a5b565b60405180910390a3505050565b611452848484610e61565b61145e848484846117fd565b61149d576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611494906127c9565b60405180910390fd5b50505050565b60008073ffffffffffffffffffffffffffffffffffffffff166114c58361115a565b73ffffffffffffffffffffffffffffffffffffffff1614159050919050565b600073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1603611553576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161154a90612835565b60405180910390fd5b61155c816114a3565b1561159c576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611593906128a1565b60405180910390fd5b6115aa6000838360016117f1565b6115b3816114a3565b156115f3576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016115ea906128a1565b60405180910390fd5b6001600360008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008282540192505081905550816002600083815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550808273ffffffffffffffffffffffffffffffffffffffff16600073ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef60405160405180910390a46116fd6000838360016117f7565b5050565b61170a826114a3565b611749576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161174090612933565b60405180910390fd5b806008600084815260200190815260200160002090816117699190612aff565b505050565b611776611197565b600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff16036117e5576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016117dc90612c43565b60405180910390fd5b6117ee81611215565b50565b50505050565b50505050565b600061181e8473ffffffffffffffffffffffffffffffffffffffff16611984565b15611977578373ffffffffffffffffffffffffffffffffffffffff1663150b7a02611847610d0b565b8786866040518563ffffffff1660e01b81526004016118699493929190612cb8565b6020604051808303816000875af19250505080156118a557506040513d601f19601f820116820180604052508101906118a29190612d19565b60015b611927573d80600081146118d5576040519150601f19603f3d011682016040523d82523d6000602084013e6118da565b606091505b50600081510361191f576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611916906127c9565b60405180910390fd5b805181602001fd5b63150b7a0260e01b7bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916817bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19161491505061197c565b600190505b949350505050565b6000808273ffffffffffffffffffffffffffffffffffffffff163b119050919050565b6000604051905090565b600080fd5b600080fd5b60007fffffffff0000000000000000000000000000000000000000000000000000000082169050919050565b6119f0816119bb565b81146119fb57600080fd5b50565b600081359050611a0d816119e7565b92915050565b600060208284031215611a2957611a286119b1565b5b6000611a37848285016119fe565b91505092915050565b60008115159050919050565b611a5581611a40565b82525050565b6000602082019050611a706000830184611a4c565b92915050565b600081519050919050565b600082825260208201905092915050565b60005b83811015611ab0578082015181840152602081019050611a95565b60008484015250505050565b6000601f19601f8301169050919050565b6000611ad882611a76565b611ae28185611a81565b9350611af2818560208601611a92565b611afb81611abc565b840191505092915050565b60006020820190508181036000830152611b208184611acd565b905092915050565b6000819050919050565b611b3b81611b28565b8114611b4657600080fd5b50565b600081359050611b5881611b32565b92915050565b600060208284031215611b7457611b736119b1565b5b6000611b8284828501611b49565b91505092915050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000611bb682611b8b565b9050919050565b611bc681611bab565b82525050565b6000602082019050611be16000830184611bbd565b92915050565b611bf081611bab565b8114611bfb57600080fd5b50565b600081359050611c0d81611be7565b92915050565b60008060408385031215611c2a57611c296119b1565b5b6000611c3885828601611bfe565b9250506020611c4985828601611b49565b9150509250929050565b600080600060608486031215611c6c57611c6b6119b1565b5b6000611c7a86828701611bfe565b9350506020611c8b86828701611bfe565b9250506040611c9c86828701611b49565b9150509250925092565b600060208284031215611cbc57611cbb6119b1565b5b6000611cca84828501611bfe565b91505092915050565b611cdc81611b28565b82525050565b6000602082019050611cf76000830184611cd3565b92915050565b600081519050919050565b600082825260208201905092915050565b6000819050602082019050919050565b611d3281611b28565b82525050565b6000611d448383611d29565b60208301905092915050565b6000602082019050919050565b6000611d6882611cfd565b611d728185611d08565b9350611d7d83611d19565b8060005b83811015611dae578151611d958882611d38565b9750611da083611d50565b925050600181019050611d81565b5085935050505092915050565b60006020820190508181036000830152611dd58184611d5d565b905092915050565b611de681611a40565b8114611df157600080fd5b50565b600081359050611e0381611ddd565b92915050565b60008060408385031215611e2057611e1f6119b1565b5b6000611e2e85828601611bfe565b9250506020611e3f85828601611df4565b9150509250929050565b600080fd5b600080fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b611e8b82611abc565b810181811067ffffffffffffffff82111715611eaa57611ea9611e53565b5b80604052505050565b6000611ebd6119a7565b9050611ec98282611e82565b919050565b600067ffffffffffffffff821115611ee957611ee8611e53565b5b611ef282611abc565b9050602081019050919050565b82818337600083830152505050565b6000611f21611f1c84611ece565b611eb3565b905082815260208101848484011115611f3d57611f3c611e4e565b5b611f48848285611eff565b509392505050565b600082601f830112611f6557611f64611e49565b5b8135611f75848260208601611f0e565b91505092915050565b60008060008060808587031215611f9857611f976119b1565b5b6000611fa687828801611bfe565b9450506020611fb787828801611bfe565b9350506040611fc887828801611b49565b925050606085013567ffffffffffffffff811115611fe957611fe86119b6565b5b611ff587828801611f50565b91505092959194509250565b600067ffffffffffffffff82111561201c5761201b611e53565b5b61202582611abc565b9050602081019050919050565b600061204561204084612001565b611eb3565b90508281526020810184848401111561206157612060611e4e565b5b61206c848285611eff565b509392505050565b600082601f83011261208957612088611e49565b5b8135612099848260208601612032565b91505092915050565b600080604083850312156120b9576120b86119b1565b5b60006120c785828601611bfe565b925050602083013567ffffffffffffffff8111156120e8576120e76119b6565b5b6120f485828601612074565b9150509250929050565b60008060408385031215612115576121146119b1565b5b600061212385828601611bfe565b925050602061213485828601611bfe565b9150509250929050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b6000600282049050600182168061218557607f821691505b6020821081036121985761219761213e565b5b50919050565b7f4552433732313a20617070726f76616c20746f2063757272656e74206f776e6560008201527f7200000000000000000000000000000000000000000000000000000000000000602082015250565b60006121fa602183611a81565b91506122058261219e565b604082019050919050565b60006020820190508181036000830152612229816121ed565b9050919050565b7f4552433732313a20617070726f76652063616c6c6572206973206e6f7420746f60008201527f6b656e206f776e6572206f7220617070726f76656420666f7220616c6c000000602082015250565b600061228c603d83611a81565b915061229782612230565b604082019050919050565b600060208201905081810360008301526122bb8161227f565b9050919050565b7f4552433732313a2063616c6c6572206973206e6f7420746f6b656e206f776e6560008201527f72206f7220617070726f76656400000000000000000000000000000000000000602082015250565b600061231e602d83611a81565b9150612329826122c2565b604082019050919050565b6000602082019050818103600083015261234d81612311565b9050919050565b7f4552433732313a20696e76616c696420746f6b656e2049440000000000000000600082015250565b600061238a601883611a81565b915061239582612354565b602082019050919050565b600060208201905081810360008301526123b98161237d565b9050919050565b7f4552433732313a2061646472657373207a65726f206973206e6f74206120766160008201527f6c6964206f776e65720000000000000000000000000000000000000000000000602082015250565b600061241c602983611a81565b9150612427826123c0565b604082019050919050565b6000602082019050818103600083015261244b8161240f565b9050919050565b7f4552433732314d657461646174613a2055524920717565727920666f72206e6f60008201527f6e6578697374656e7420746f6b656e0000000000000000000000000000000000602082015250565b60006124ae602f83611a81565b91506124b982612452565b604082019050919050565b600060208201905081810360008301526124dd816124a1565b9050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b600061251e82611b28565b91507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff82036125505761254f6124e4565b5b600182019050919050565b7f4552433732313a207472616e736665722066726f6d20696e636f72726563742060008201527f6f776e6572000000000000000000000000000000000000000000000000000000602082015250565b60006125b7602583611a81565b91506125c28261255b565b604082019050919050565b600060208201905081810360008301526125e6816125aa565b9050919050565b7f4552433732313a207472616e7366657220746f20746865207a65726f2061646460008201527f7265737300000000000000000000000000000000000000000000000000000000602082015250565b6000612649602483611a81565b9150612654826125ed565b604082019050919050565b600060208201905081810360008301526126788161263c565b9050919050565b7f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e6572600082015250565b60006126b5602083611a81565b91506126c08261267f565b602082019050919050565b600060208201905081810360008301526126e4816126a8565b9050919050565b7f4552433732313a20617070726f766520746f2063616c6c657200000000000000600082015250565b6000612721601983611a81565b915061272c826126eb565b602082019050919050565b6000602082019050818103600083015261275081612714565b9050919050565b7f4552433732313a207472616e7366657220746f206e6f6e20455243373231526560008201527f63656976657220696d706c656d656e7465720000000000000000000000000000602082015250565b60006127b3603283611a81565b91506127be82612757565b604082019050919050565b600060208201905081810360008301526127e2816127a6565b9050919050565b7f4552433732313a206d696e7420746f20746865207a65726f2061646472657373600082015250565b600061281f602083611a81565b915061282a826127e9565b602082019050919050565b6000602082019050818103600083015261284e81612812565b9050919050565b7f4552433732313a20746f6b656e20616c7265616479206d696e74656400000000600082015250565b600061288b601c83611a81565b915061289682612855565b602082019050919050565b600060208201905081810360008301526128ba8161287e565b9050919050565b7f4552433732314d657461646174613a2055524920736574206f66206e6f6e657860008201527f697374656e7420746f6b656e0000000000000000000000000000000000000000602082015250565b600061291d602c83611a81565b9150612928826128c1565b604082019050919050565b6000602082019050818103600083015261294c81612910565b9050919050565b60008190508160005260206000209050919050565b60006020601f8301049050919050565b600082821b905092915050565b6000600883026129b57fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff82612978565b6129bf8683612978565b95508019841693508086168417925050509392505050565b6000819050919050565b60006129fc6129f76129f284611b28565b6129d7565b611b28565b9050919050565b6000819050919050565b612a16836129e1565b612a2a612a2282612a03565b848454612985565b825550505050565b600090565b612a3f612a32565b612a4a818484612a0d565b505050565b5b81811015612a6e57612a63600082612a37565b600181019050612a50565b5050565b601f821115612ab357612a8481612953565b612a8d84612968565b81016020851015612a9c578190505b612ab0612aa885612968565b830182612a4f565b50505b505050565b600082821c905092915050565b6000612ad660001984600802612ab8565b1980831691505092915050565b6000612aef8383612ac5565b9150826002028217905092915050565b612b0882611a76565b67ffffffffffffffff811115612b2157612b20611e53565b5b612b2b825461216d565b612b36828285612a72565b600060209050601f831160018114612b695760008415612b57578287015190505b612b618582612ae3565b865550612bc9565b601f198416612b7786612953565b60005b82811015612b9f57848901518255600182019150602085019450602081019050612b7a565b86831015612bbc5784890151612bb8601f891682612ac5565b8355505b6001600288020188555050505b505050505050565b7f4f776e61626c653a206e6577206f776e657220697320746865207a65726f206160008201527f6464726573730000000000000000000000000000000000000000000000000000602082015250565b6000612c2d602683611a81565b9150612c3882612bd1565b604082019050919050565b60006020820190508181036000830152612c5c81612c20565b9050919050565b600081519050919050565b600082825260208201905092915050565b6000612c8a82612c63565b612c948185612c6e565b9350612ca4818560208601611a92565b612cad81611abc565b840191505092915050565b6000608082019050612ccd6000830187611bbd565b612cda6020830186611bbd565b612ce76040830185611cd3565b8181036060830152612cf98184612c7f565b905095945050505050565b600081519050612d13816119e7565b92915050565b600060208284031215612d2f57612d2e6119b1565b5b6000612d3d84828501612d04565b9150509291505056fea264697066735822122024b854a4a0b42fe9384463bf63e28d8f916807b9c4f63a60dbe7c7bdb3c0a33064736f6c63430008120033"})
                  
                    const gas = 3000000; // Set the gas limit to 3000000
                    const options = {
                        from: accounts[0],
                        gas: gas, // Pass the gas limit to the send method
                    };

                    //arguments to the constructor
                    const args = [
                        "test",
                        "test",
                    ]

                    //deploys the nft smart contract
                    const contract = await NFTContract.deploy({
                            arguments: args
                    }).send(options);

                    this.contract.address = contract.options.address;
                    this.contract.instance = new web3.eth.Contract(nftABI, this.contract.address);

                    //mints a users nft to thier account
                    await contract.methods.mint(this.accountInstance, url).send({from: accounts[0]})


                    //load tokens owned by the owner if it exists
                    const tokenIds = await contract.methods.tokensOfOwner(this.accountInstance).call()
                    this.tokens = tokenIds;

                    const uri = await contract.methods.tokenURI(tokenIds[0]).call()
                    Toastify({
                            text: "NFT uploaded "+this.contract.address + "with uri "+uri,
                            position: "center",
                    }).showToast();




                    










                    
                    break;
                }
             }


             
            
            //await this.getAddress();

        },




    }

}

</script>

<style>
</style>